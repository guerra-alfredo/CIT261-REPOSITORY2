<!DOCTYPE HTML>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
        <title>CIT 261 Assignment Portal | Alfredo Guerra| BYU-Idaho</title>
		<meta name="description" content="Assignment portal page for Alfredo Guerra in CIT 261">
		<meta name="viewport" content="width=device-width, initialscale=1">
		<link href="styles/large.css" rel="stylesheet">
                <link href="styles/large4.css" rel="stylesheet">

	</head>
	
	<body>
        <div class="content">	
            <header class="spaceAround">
                <a href="../index.html"><img id="sizeLink" src="images/backToMain.png" alt="Back to Main" width="310" height="60"></a><br>
            </header>
            <nav>
                <!-- future main memu -->
            </nav>
			
            <main class="spaceAround">
                <h3 class="titleContent">TOPIC 4: Using XMLHTTPRequest to Consume a JSON Web Service</h3>   
                <p>1.- In this example I am using a web service to get data of the planets from a page called <a href="http://www.astropical.space/astrodb/api-ephem.php?">http://www.astropical.space</a>, this data is in JSON format I used XMLHttpRequest.</p>
                <p id="studentData"></p>
                <script>
                  //http://www.astropical.space/astrodb/apiref.php
                  //http://www.astropical.space/astrodb/api-ephem.php?lat=35&lon=139
                  //http://www.astropical.space/astrodb/api-ephem.php?
                  //Get all stars up to 32 light-years in JSON
                  //api.php?table=stars&which=distance&limit=32&format=json
                  var x = "";
                  var xmlhttp = new XMLHttpRequest();
                  xmlhttp.onreadystatechange = function(){
                      if(this.readyState == 4 && this.status == 200){
                          var planets = JSON.parse(this.responseText);

                          //this api fetches 5000 photos, but I don't want to display that many
                          for(i in planets.response){

                               x += planets.response[i].id+" <strong>Planet</strong>:"+"  "+planets.response[i].name+" - <strong>Const</strong>: "+planets.response[i].const+" - <strong>au_sun</strong>: "+planets.response[i].au_sun+"<br>";
                          }

                          document.getElementById("studentData").innerHTML = x;
                      }  
                  };
                  xmlhttp.open("GET", "http://www.astropical.space/astrodb/api-ephem.php?", true);
                  xmlhttp.send();
              </script> 

                <p>2.- I have a default list of several courses for one student, this data is in a document inside the server files, to get access I am using <strong class="clor">XMLHTTPRequest</strong>, as the data is in JSON format I must to use <strong class="clor">JSON.parse()</strong> to convert it and use the data</p>
              
                <a href="student.txt" target="_blank">DOC: Single Student</a><br><br>
                                <button onclick="displayList1()">Display Student</button><br>
                <p id="listStu"></p><br><br>

                <p>3.- In this example I am displaying several students with their grades by courses.
                to do that I used <strong class="clor">XMLHTTPRequest</strong> to get the data from the server and I am using 
                <strong class="clor">JSON.parse()</strong> to convert it and use the data</p>

                <a href="students.txt" target="_blank">DOC: Several Student</a><br><br>
                <button onclick="displayList2()">Display List Student</button>
                <p id="listStu2"></p><br>

                <p>4.- This example search for a specific student by writing <strong class="clor">the name of the student</strong>, the name list is given in the upper list of students</p>

                <form class ="form1">
                    <h3>Search student by Name</h3>
                    <label for="fname">First Name</label>
                    <input type="text" id="fname" name="fname">
                    <br><br>
                    <button class="button button1" type="button" onclick="displayList3()">Search</button>	
                </form>
                <p id="listStu3"></p>



            </main>
            <footer>
                <br><br>
                <p>&copy; 2018, Alfredo Guerra, Chile, <a href="http://www.byui.edu/online">BYU-Idaho Online Learning</a></p>
            </footer>
        </div>
        <script src="scripts/topic4.js"></script>
	</body>
</html>